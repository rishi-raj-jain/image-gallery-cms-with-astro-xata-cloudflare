---
const { selector, className = '' } = Astro.props

const attribute = 'custom_upload_' + selector + '_'
---

<input class="hidden" id={attribute} name={attribute} />

<input class="hidden" id={attribute + '_uploaded_h'} name={attribute + '_uploaded_h'} />
<input class="hidden" id={attribute + '_uploaded_w'} name={attribute + '_uploaded_w'} />

<div
  id={attribute + '_uploaded_image'}
  class={[className, 'hidden', 'relative'].filter((i) => i).join(' ')}
  onclick={`document.getElementById('${attribute + '_initial_uploader'}').click()`}
>
  <svg
    width="24"
    height="24"
    viewBox="0 -960 960 960"
    xmlns="http://www.w3.org/2000/svg"
    class="absolute right-0 top-0 z-20 cursor-pointer rounded-full border bg-white shadow"
  >
    <path
      d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"
    ></path>
  </svg>
  <input class="hidden" id={attribute + '_uploaded_image_url'} name={attribute + '_uploaded_image_url'} />
  <img class={[className].filter((i) => i).join(' ')} />
</div>

<div
  id={attribute + '_uploader'}
  onclick={`document.getElementById('${attribute + '_initial_uploader'}').click()`}
  class={['flex cursor-pointer flex-col items-center justify-center rounded border py-12'].filter((i) => i).join(' ')}
>
  <svg class="fill-gray-400" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
    <path
      d="M260-160q-91 0-155.5-63T40-377q0-78 47-139t123-78q25-92 100-149t170-57q117 0 198.5 81.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H520q-33 0-56.5-23.5T440-240v-206l-64 62-56-56 160-160 160 160-56 56-64-62v206h220q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-83-58.5-141.5T480-720q-83 0-141.5 58.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41h100v80H260Zm220-280Z"
    ></path>
  </svg>
  <span>Upload Image</span>
</div>

<input class="hidden" id={attribute + '_initial_uploader'} type="file" />
